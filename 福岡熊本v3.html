<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç¦å²¡ç†Šæœ¬è¡Œç¨‹è¦åŠƒï¼ˆé›²ç«¯åŒæ­¥ï¼‰</title>
<style>

    body {

      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;

      margin: 20px;

    }

    input, button {

      padding: 6px;

      margin: 4px 0;

    }

    .item {

      border-bottom: 1px solid #ddd;

      padding: 6px 0;

    }
</style>
<!-- ğŸ”¥ Firebase SDKï¼ˆä¸€å®šè¦ type="module"ï¼‰ -->
<script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

    import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // âœ… ä½ çš„ Firebase è¨­å®š

    const firebaseConfig = {

      apiKey: "AIzaSyBRjYjvwvCNTRHdI8vH8n3GPabzSnSDbvI",

      authDomain: "jp-b0e03.firebaseapp.com",

      projectId: "jp-b0e03",

      storageBucket: "jp-b0e03.firebasestorage.app",

      messagingSenderId: "689610031212",

      appId: "1:689610031212:web:f63f2efe61d4ad562bd849"

    };

    const app = initializeApp(firebaseConfig);

    const db = getFirestore(app);

    // ğŸŒ çµ¦ä¸‹é¢ä¸€èˆ¬ JS ä½¿ç”¨

    window.db = db;

    window.fbDoc = doc;

    window.fbGetDoc = getDoc;

    window.fbSetDoc = setDoc;

    window.fbOnSnapshot = onSnapshot;
</script>
</head>
<body>
<h2>ğŸ‡¯ğŸ‡µ ç¦å²¡ / ç†Šæœ¬ è¡Œç¨‹è¦åŠƒï¼ˆé›²ç«¯åŒæ­¥ï¼‰</h2>
<input id="dateInput" placeholder="æ—¥æœŸï¼ˆä¾‹ï¼šDay 1ï¼‰">
<input id="textInput" placeholder="è¡Œç¨‹å…§å®¹">
<button onclick="addItem()">æ–°å¢</button>
<div id="list"></div>
<script>

    /* ===============================

       ğŸ”¹ è³‡æ–™å€

    =============================== */

    let ITINERARY_DATA = {};

    const DOC_REF = fbDoc(db, "travelPlanner", "fukuoka_kumamoto");

    /* ===============================

       ğŸ”¹ Firebase è®€å–

    =============================== */

    async function loadFromFirebase() {

      const snap = await fbGetDoc(DOC_REF);

      if (snap.exists()) {

        ITINERARY_DATA = snap.data().itinerary || {};

      }

      render();

    }

    /* ===============================

       ğŸ”¹ Firebase å„²å­˜

    =============================== */

    async function saveToFirebase() {

      await fbSetDoc(DOC_REF, {

        itinerary: ITINERARY_DATA

      });

    }

    /* ===============================

       ğŸ”¹ å³æ™‚åŒæ­¥ï¼ˆè·¨è£ç½®ï¼‰

    =============================== */

    fbOnSnapshot(DOC_REF, (snap) => {

      if (snap.exists()) {

        ITINERARY_DATA = snap.data().itinerary || {};

        render();

      }

    });

    /* ===============================

       ğŸ”¹ æ–°å¢è¡Œç¨‹

    =============================== */

    function addItem() {

      const date = document.getElementById("dateInput").value;

      const text = document.getElementById("textInput").value;

      if (!date || !text) return;

      if (!ITINERARY_DATA[date]) {

        ITINERARY_DATA[date] = [];

      }

      ITINERARY_DATA[date].push(text);

      document.getElementById("textInput").value = "";

      saveToFirebase();

      render();

    }

    /* ===============================

       ğŸ”¹ é¡¯ç¤ºç•«é¢

    =============================== */

    function render() {

      const list = document.getElementById("list");

      list.innerHTML = "";

      for (const date in ITINERARY_DATA) {

        const h3 = document.createElement("h3");

        h3.textContent = date;

        list.appendChild(h3);

        ITINERARY_DATA[date].forEach(item => {

          const div = document.createElement("div");

          div.className = "item";

          div.textContent = "â€¢ " + item;

          list.appendChild(div);

        });

      }

    }

    window.addEventListener("load", loadFromFirebase);
</script>
</body>
</html>
 